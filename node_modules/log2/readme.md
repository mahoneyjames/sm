# About

A simple(ish) library for batching up log messages into a single entry in Cloudwatch
This is handy for things like tracking database calls, or external API calls. 

A rough example
```
    const consoleLogger = require("log2")("queue-adhoc-admin-1");

    //get a log record
    logRecord = consoleLogger.track("something");

    //add something to it
    logRecord.merge({"record": record});

    //add other things to it
    logRecord.setData("result", "exception");
    logRecord.merge({"exception": exception.message, stack: exception.stack});

    //nothing is saved yet
            
    //This call is needed at the end to get log records written out to the console
    LogFactory.writeUnsavedRecords();
```
# Status

The basics are done. Used by code in the storyclub repository, and also by the lambdas in the sm repository.


## future stuff to improve the logging

 - [ ] copy the log levels from a well known logging platform  
 - [ ] cope with entry being bigger than 256kb
 - [ ] a way to format exceptions so taht we can query them nicely - look at how bunyan does this?
 - [ ] cope with a *new* request coming in when there is unsaved log data? i.e. a different request id...
 - [ ] I have jumped through some hoops to make LogFactory a Singleton - better to create a "log" instance, and pass it into classes that require it? 
 - [ ] extend the dynamodb helper library so we can switch on logs of queries that are run?
 - [ ] option to turn off logging of the http response
